  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Rock-Scissors-Paper</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
    <style>
      .player{
        display: flex;
        align-items: cneter;
        height: 40px;
      }
      .player span{
        display: inline-block;
        width: 200px;
      }
    </style>
  </head>
  <body onload="onload()">
    <div class="container">
      <h1>Rock, Scissors, Paper!</h1>
      
      <div class="userJoin" id="userJoin">
        <p id="userNameLabel">User Name:</p>
        <input id="userName" type="text" value="" placeholder="Enter Username" />
        <button id="join">Join!</button>
      </div>

      <div class="gamePage">

        <div class="sectionArea">
          <img class="image" id="rock" src="/img/rock.png" />
          <img class="image" id="scissors" src="/img/scissors.png" />
          <img class="image" id="paper" src="/img/paper.png" />

          <div id="info">
            <div class="player">
              <div class="player-name">Player1: <span id="player1"></span></div>
              <div class="player-choice">Choice: <span id="choice1"></span></div>
            </div>

            <div class="player">
              <div class="player-name">Player2: <span id="player2"></span></div>
              <div class="player-choice">Choice: <span id="choice2"></span></div>
            </div>

            <div class="message">
              <div id="tips">

              </div>
            </div>

          </div>

        </div>



      </div>
    </div>
    
  </body>

  <script>
    function onload(){
      var socket = io.connect();
      var submitted = false; //player submit chioce
      var userName = "";

      document.getElementById("join").onclick = onJoin;
      var images = document.getElementsByClassName("image");

      for(var i in images){
        images[i].onclick = onImageClick;
      }

      alert("Please input your name to join.");

      
      socket.on('user join', function(userName, users) {
        var $player1= document.getElementById("player1");
        var $player2= document.getElementById("player2");
        if(users[0]){$player1.innerHTML = users[0].name;}
        if(users[1]){$player2.innerHTML = users[1].name;}
        if(users.length == 0)
          return;
        if(users.length == 1){
          $player1.innerHTML = users[0].name;
          alert("Waiting for other players join.");
        }
        if(users.length >= 2){
          $player1.innerHTML = users[0].name;
          $player2.innerHTML = users[1].name;
          alert("Game start. Make your choice.");
        }
      });   
      
      socket.on('user enter', function(users){
        var $player1= document.getElementById("player1");
        var $player2= document.getElementById("player2");
        if(users.length == 0)
          return;
        if(users.length == 1){
          $player1.innerHTML = users[0].name;
        }
        if(users.length >= 2){
          $player1.innerHTML = users[0].name;
          $player2.innerHTML = users[1].name;
        }
      });


      socket.on('user left', function(userName,users) {
        var $player1= document.getElementById("player1");
        var $player2= document.getElementById("player2");
        $player1.innerHTML = "";
        $player2.innerHTML = "";
        if(users.length == 1)
          $player1.innerHTML = users[0].name;
      });

      socket.on('user choice', function(userName, choice){
        var $choice1= document.getElementById("choice1");
        var $choice2= document.getElementById("choice2");
        $choice1.innerHTML = choice[0].choice;
        if(choice.length == 2)
          $choice2.innerHTML = choice[1].choice
      });

      socket.on('game over', function (player, result) {
        let tips = "";
        if(result.winner ){
          tips = "Winner: " + result.winner.name;
        }else{
          tips = "A tie!"
        }
        alert(tips);
        submitted = false;
      });

      function onJoin(){
        userName=document.getElementById('userName').value;
        if(userName == ""){
          alert("Please input your name to join.")
          return
        }
        
        socket.emit('add user', userName, function(data) {
          if(result.status == 0){
            document.getElementById("userJoin").innerHTML = "<p>User Name:<span>" + userName +  "</span></p >";
          }else if(result.status == 1){
            alert(userName + " username is already in use.");
          }else if(result.status == 2){
            alert("room full.")
          }
        });

      }

      function onImageClick(choice){
        var choice = event.target.id;
        if(!submitted){
          submitted = true;
          socket.emit('player choice', userName, choice);
          alert("Waiting for other player...");
        }else{
          alert("You have already made a choice!");
        } 
      }

    }
  </script>
  </html>